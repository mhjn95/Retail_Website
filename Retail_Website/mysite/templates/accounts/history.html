{% extends 'customerbase.html' %}
{% load static %}
{% block content %}

<div id="content">

            <div class="container-fluid" id='blocker'>
                <div class="d-sm-flex justify-content-between align-items-center mb-4">
                    <h3 class="text-dark mb-0"><strong>Complaint</strong></h3>
                </div>
            </div>
            <div class="card" style="padding: 0px;margin: 20px;">
                <div class="card-body">
                  {% include 'partials/_alerts.html' %}
                    <div>
                        <div class="tab-content">
                            <div class="tab-pane active" role="tabpanel" id="tab-1">
                                <div class="card" style="margin: 20px;margin-top: 30px;margin-right: 10px;margin-bottom: 10px;margin-left: 10px;">
                                    <div class="card-body">
                                        <h3 style="font-size: 28px;">Your Accepted RFQ's</h3>
                                        <div class="row">

                                        </div>


                                        <div class="table-responsive table mt-2" id="dataTable" role="grid" aria-describedby="dataTable_info">
                                          {% if data %}
                                            <table class="table dataTable my-0" id="dataTable">
                                                <thead>
                                                    <tr>

                                                        <th>Date of Complaint</th>
                                                        <th>RFQ ID</th>
                                                        <th>Manufacturer<br></th>
                                                        <th>Quote Details</th>
                                                        <th>Resolution</th>
                                                        <th>Complaint Made</th>

                                                    </tr>
                                                </thead>
                                                <tbody>
                                                  {% for da in data %}

                                                  {% if da.complaint %}
                                                  <tr>
                                                      <td>{{ da.list_date | date:"d F Y" }}</td>
                                                      <td>{{ da.unique_id }}</td>
                                                      <td>{{ da.uname }}</td>
                                                      <td>
                                                        <a class="btn btn-sm btn-primary " style='align:center' data-toggle="modal" data-toggle='modal' href="#postEditModal{{ da.unique_id }}">Show</a>

                                                        <div id="postEditModal{{ da.unique_id }}" class="modal fade" style="overflow: scroll;" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                                          <div class="modal-dialog modal-dialog-scrollable" role="document">
                                                              <div class="modal-content">
                                                                  <div class="modal-header mt-2 ml-2">
                                                                      <h4> <strong>Details </strong></h4>
                                                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
                                                                  <div class="modal-body">
                                                                      <div class="row">
                                                                        <strong class="ml-3 mr-2">Estimate Cost : </strong>
                                                                        <p class="ml-2">{{ da.estimatecost }}</p>
                                                                      </div>
                                                                      <div class="row">
                                                                        <strong class="ml-3 mr-2">Estimate Days : </strong>
                                                                        <p class="ml-2">{{ da.estimatedays }}</p>
                                                                      </div>
                                                                      <div class="row">
                                                                        <strong class="ml-3 mr-2">Additional Details : </strong>
                                                                        <p class="ml-2">{{ da.moreinfo }}</p>
                                                                      </div>
                                                                  </div>
                                                              </div>
                                                          </div>
                                                        </div>
                                                      </td>

                                                      <td>
                                                        <a class="btn btn-sm btn-primary " data-toggle="modal" data-toggle='modal' href="#tEditModal{{ da.unique_id }}">Show</a>

                                                        <div id="tEditModal{{ da.unique_id }}" class="modal fade" style="overflow: scroll;" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                                          <div class="modal-dialog modal-dialog-scrollable" role="document">
                                                              <div class="modal-content">
                                                                  <div class="modal-header">
                                                                      <h4><strong>Resolution</strong></h4>
                                                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
                                                                  <div class="modal-body">
                                                                      {{da.resolutions}}
                                                                  </div>
                                                              </div>
                                                          </div>
                                                        </div>
                                                      </td>

                                                      <td>
                                                        <a class="btn btn-sm btn-primary " data-toggle="modal" data-toggle='modal' href="#ostEditModal{{ da.unique_id }}">Show</a>

                                                        <div id="ostEditModal{{ da.unique_id }}" class="modal fade" style="overflow: scroll;" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                                          <div class="modal-dialog modal-dialog-scrollable" role="document">
                                                              <div class="modal-content">
                                                                  <div class="modal-header">
                                                                      <h4 class="mt-2">Your Complaint : </h4>
                                                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
                                                                  <div class="modal-body">
                                                                    <div class="container">
                                                                      <div class="row">
                                                                        <strong>Problems : </strong>
                                                                        <p class="ml-3">{{ da.complaintchoices }}</p>
                                                                      </div>
                                                                      <div class="row">
                                                                        <strong>Complsint Title : </strong>
                                                                        <p class="mx-3"> {{ da.complaintitle }} </p>
                                                                      </div>
                                                                      <div class="row">
                                                                        <strong>Complaint Details : </strong>
                                                                        <p class="mx-3"> {{ da.complaint }}</p>
                                                                      </div>
                                                                    </div>

                                                                  </div>
                                                              </div>
                                                          </div>
                                                        </div>
                                                      </td>
                                                  </tr>


                                                  {% else %}
                                                    <tr>
                                                        <td>{{ da.list_date | date:"d F Y" }}</td>
                                                        <td>{{ da.unique_id }}</td>
                                                        <td>{{ da.uname }}</td>

                                                        <td>
                                                          <a class="btn btn-sm btn-primary" style='align:center' data-toggle="modal" data-toggle='modal' href="#postEditModal{{ da.unique_id }}">Show</a>

                                                          <div id="postEditModal{{ da.unique_id }}" class="modal fade" style="overflow: scroll;" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                                            <div class="modal-dialog modal-dialog-scrollable" role="document">
                                                                <div class="modal-content">
                                                                    <div class="modal-header mt-2 ml-2">
                                                                        <h4> <strong>Details </strong></h4>
                                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
                                                                    <div class="modal-body">
                                                                        <div class="row">
                                                                          <strong class="ml-3 mr-2">Estimate Cost : </strong>
                                                                          <p class="ml-2">{{ da.estimatecost }}</p>
                                                                        </div>
                                                                        <div class="row">
                                                                          <strong class="ml-3 mr-2">Estimate Days : </strong>
                                                                          <p class="ml-2">{{ da.estimatedays }}</p>
                                                                        </div>
                                                                        <div class="row">
                                                                          <strong class="ml-3 mr-2">Additional Details : </strong>
                                                                          <p class="ml-2">{{ da.moreinfo }}</p>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                          </div>
                                                        </td>
                                                        <td> - </td>
                                                        <td>
                                                          <a class="btn btn-primary btn-sm" role="button" data-toggle="modal" href="#complain">Complain</a>
                                                        </td>
                                                    </tr>
                                                    <div class="modal fade" role="dialog" tabindex="-1" id="complain" style="margin: 10px;">
                                                        <div class="modal-dialog modal-dialog-scrollable" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h4><strong>File a Complaint</strong></h4>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
                                                                <div class="modal-body">
                                                                    <form method="POST">
                                                                      {% csrf_token %}
                                                                        <div class="form-row" style="margin-bottom: 5px;">
                                                                          <div class="col"><small class="form-text text-muted" style="font-size: 14px;"><strong>Select your problem(s)</strong><br></small>
                                                                              <div class="form-check" style="padding-left: 0px;"><input value='Dimensions are undersize or oversize' class="form-check-input hex3" type="checkbox" id="dauo" style="width: 60px;">            <label class="form-check-label" for="dauo" style="padding-left: 25px;">Dimensions are undersize or oversize<br></label></div>
                                                                              <div class="form-check" style="padding-left: 0px;"><input value='Some Operations are missed out' class="form-check-input hex3" type="checkbox" id="somo" style="width: 60px;">                  <label class="form-check-label" for="somo" style="padding-left: 25px;">Some Operations are missed out<br></label></div>
                                                                              <div class="form-check" style="padding-left: 0px;"><input value='Surface Finish and tool marks related problems' class="form-check-input hex3" type="checkbox" id="sftmrp" style="width: 60px;"><label class="form-check-label" for="sftmrp" style="padding-left: 25px;">Surface Finish and tool marks related problems<br></label></div>
                                                                              <div class="form-check" style="padding-left: 0px;"><input value='Any other problem(s)' class="form-check-input hex3" type="checkbox" id="aop" style="width: 60px;">                             <label class="form-check-label" for="aop" style="padding-left: 25px;">Any other problem(s)</label></div>
                                                                              <p></p>
                                                                              <input type="text" id='hexid3' name="complaintoptions">
                                                                              <p></p>
                                                                              <input class="form-control mt-4 mb-2" type="text" name='complaintitle' placeholder="Complaint Title" required="">
                                                                              <textarea class="form-control mb-2" name="complain" placeholder="Type Your Complain Here..." style="margin-bottom: 10px;" rows="4" required=""></textarea>
                                                                          </div>
                                                                        </div>
                                                                          <input type="hidden" name="uname" value="{{da.uname}}">
                                                                          <input type="hidden" name="unique_id" value="{{da.unique_id}}">
                                                                        <button name='complaint' class="btn btn-primary mt-2" type="submit">SEND</button>
                                                                    </form>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {% endif %}

                                                  {% endfor %}

                                                </tbody>
                                                <tfoot>
                                                    <tr></tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                        {% else %}
                                        <p class="p-4"><strong>You have not accepted any RFQs yet !</strong></p>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>






                        </div>
                    </div>
                </div>

                <div class="row ml-3">
                  <div class="col-md-6 align-self-center">
                    {% if count > 6 %}
                      <p id="dataTable_info" class="dataTables_info" role="status" aria-live="polite">Total Entries: {{ count }}</p>
                    {% endif %}
                  </div>
                  <div class="col-md-12">
                    {% if data.has_other_pages %}
                    <ul class="pagination">
                      {% if data.has_previous %}
                      <li class='page-item'>
                        <a href="?page={{data.previous_page_number}}" class='page-link'>
                          &laquo;
                        </a>
                      </li>
                      {% else %}
                      <li class='page-item disabled'>
                        <a class='page-link'>&laquo;</a>
                      </li>
                      {% endif %}
                      {% for i in data.paginator.page_range %}
                      {% if data.number == i %}
                      <li class='page-item active'>
                        <a class='page-link'>{{i}}</a>
                      </li>
                      {% else %}
                      <li class='page-item'>
                        <a href="?page={{i}}" class='page-link'>{{i}}</a>
                      </li>
                      {% endif %}
                      {% endfor %}
                      {% if data.has_next %}
                      <li class='page-item'>
                        <a href="?page={{data.next_page_number}}" class='page-link'>
                          &raquo;
                        </a>
                      </li>
                      {% else %}
                      <li class='page-item disabled'>
                        <a class='page-link'>&raquo;</a>
                      </li>
                      {% endif %}
                    </ul>
                    {% endif %}
                  </div>
                </div>

            </div>
        </div>
{% endblock %}
